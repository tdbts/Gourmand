(this.webpackJsonpgourmand=this.webpackJsonpgourmand||[]).push([[0],{35:function(e,t,n){},36:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(3),i=n.n(a),r=n(12),o=n.n(r),s=(n(34),n(35),n(11)),u=(n.p,n(36),n(50)),l=n(51),d=n(52),j=n(53),h=n(54),f=n(48),g=n(49);var b=function(e){var t=e.requestLocation;return Object(c.jsx)(f.a,{className:"suggestions-list-group",onMouseDown:function(e){return e.preventDefault()},children:Object(c.jsx)(g.a,{tag:"button",onClick:t,action:!0,children:Object(c.jsxs)("div",{className:"current-location-container",children:[Object(c.jsx)("img",{className:"current-location-icon",src:"cursor-fill.svg"}),Object(c.jsx)("span",{children:"Current Location"})]})})})};var O=function(e){var t=e.onSearchRequest,n=e.searching,i=Object(a.useState)(""),r=Object(s.a)(i,2),o=r[0],f=r[1],g=Object(a.useState)(""),O=Object(s.a)(g,2),m=O[0],v=O[1],p=Object(a.useState)(!1),x=Object(s.a)(p,2),k=x[0],y=x[1],N=function(){return y(!1)};return Object(c.jsx)("form",{className:"search-form",onSubmit:function(e){return function(e,t){e.preventDefault(),console.log("onSubmit()"),console.log("e:",e);var n=Object(s.a)(e.target,2),c=n[0],a=n[1];t(c.value,a.value)}(e,t)},children:Object(c.jsx)(u.a,{className:"input-container px-0",children:Object(c.jsxs)(l.a,{children:[Object(c.jsx)(d.a,{className:"description-input-column",xs:"12",md:"5",children:Object(c.jsxs)(l.a,{className:"description-input-row",children:[Object(c.jsx)(d.a,{xs:"3",md:"4",children:Object(c.jsx)("div",{className:"input-label",children:"Description:"})}),Object(c.jsx)(d.a,{xs:"6",md:"8",children:Object(c.jsx)("input",{className:"search-input",type:"text",value:o,onChange:function(e){f(e.target.value)},placeholder:"e.g. Pizza"})})]})}),Object(c.jsx)(d.a,{className:"location-input-column",xs:"12",md:"6",children:Object(c.jsxs)(l.a,{className:"location-input-row",children:[Object(c.jsx)(d.a,{xs:"3",md:"3",children:Object(c.jsx)("div",{className:"input-label",children:"Location:"})}),Object(c.jsxs)(d.a,{xs:"6",md:"7",children:[Object(c.jsx)("input",{className:"search-input",type:"text",value:m,onChange:function(e){v(e.target.value)},onClick:function(){return y((function(e){return!e}))},onBlur:N,placeholder:"e.g. Brooklyn, NY 11237"}),k&&Object(c.jsx)(b,{requestLocation:function(){console.log("Requesting location."),navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,n=t.latitude,c=t.longitude;v("".concat(n.toPrecision(7),", ").concat(c.toPrecision(7))),N()}),(function(e){return console.error(e)}))}})]}),Object(c.jsx)(d.a,{xs:"3",md:"2",children:Object(c.jsx)(j.a,{className:"search-button",color:"primary",children:n?Object(c.jsx)(h.a,{color:"light",size:"sm"}):"Search"})})]})})]})})})};var m=function(e){var t=e.onSearchRequest,n=e.searching;return Object(c.jsx)("div",{className:"header-container",children:Object(c.jsxs)("div",{className:"header-content-wrapper",children:[Object(c.jsx)("h1",{className:"title-header",children:"Gourmand"}),Object(c.jsx)(O,{onSearchRequest:t,searching:n})]})})},v=n(18),p=n(9),x=n(10),k=n(28),y=n(26),N=function(e){Object(k.a)(n,e);var t=Object(y.a)(n);function n(e,c,a,i){return Object(p.a)(this,n),t.call(this,e,c,a,i)}return Object(x.a)(n,[{key:"getThumbnailURLs",value:function(){var e=this.source.slice(0,-5);return[e+"258s.jpg",e+"300s.jpg",e+"348s.jpg"]}}]),n}(function(){function e(t,n,c,a){Object(p.a)(this,e),this.id=t,this.type=n,this.caption=c,this.source=a}return Object(x.a)(e,[{key:"toJSON",value:function(){return v.a.pick(this,"id","type","caption","source")}},{key:"populateFromBSON",value:function(e){var t=e.id,n=e.type,c=e.caption,a=e.source;return this.id=t,this.type=n,this.caption=c,this.source=a,this}}]),e}()),w=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return Object(c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:t,fill:n,className:"liked-media-icon",onClick:a,viewBox:"0 0 16 16",children:Object(c.jsx)("path",{d:"M4 1c2.21 0 4 1.755 4 3.92C8 2.755 9.79 1 12 1s4 1.755 4 3.92c0 3.263-3.234 4.414-7.608 9.608a.513.513 0 0 1-.784 0C3.234 9.334 0 8.183 0 4.92 0 2.755 1.79 1 4 1z"})})},I=function(e){var t=e.media,n=e.onMediaSelection,a=e.isLiked;return Object(c.jsxs)("div",{className:"food-thumbnail-container",children:[Object(c.jsx)("img",{className:"food-thumbnail",src:t.getThumbnailURLs()[0],onClick:function(){return n(t.id)}}),a&&w("16","16","white")]})};var D=function(e){var t=e.restaurants,n=e.onMediaSelection,i=e.onMediaLikeToggle,r=e.isLikedMedia,o=Object(a.useState)([]),u=Object(s.a)(o,2),l=u[0],d=u[1];return Object(a.useEffect)((function(){d(function(e){console.log("restaurants:",e);var t=e.flatMap((function(e){return e.media}));return console.log("allMedia:",t),v.a.shuffle(t).map((function(e){return(new N).populateFromBSON(e)}))}(t))}),[t]),Object(c.jsx)("div",{className:"gallery-container",children:l.map((function(e,t){return Object(c.jsx)(I,{media:e,onMediaSelection:n,onMediaLikeToggle:i,isLiked:r(e.id)},t)}))})},S=function(e){var t=e.error;return Object(c.jsxs)("div",{className:"error-message-container",children:[Object(c.jsx)("div",{className:"error-apology",children:"Oops, something went sour."}),Object(c.jsxs)("div",{className:"error-message",children:['"',t.message,'"']})]})},M=n(58),B=n(55),C=n(56),L=n(57),R=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return Object(c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:t,fill:n,className:"unliked-media-icon",onClick:a,viewBox:"0 0 16 16",children:Object(c.jsx)("path",{d:"M8 6.236l-.894-1.789c-.222-.443-.607-1.08-1.152-1.595C5.418 2.345 4.776 2 4 2 2.324 2 1 3.326 1 4.92c0 1.211.554 2.066 1.868 3.37.337.334.721.695 1.146 1.093C5.122 10.423 6.5 11.717 8 13.447c1.5-1.73 2.878-3.024 3.986-4.064.425-.398.81-.76 1.146-1.093C14.446 6.986 15 6.131 15 4.92 15 3.326 13.676 2 12 2c-.777 0-1.418.345-1.954.852-.545.515-.93 1.152-1.152 1.595L8 6.236zm.392 8.292a.513.513 0 0 1-.784 0c-1.601-1.902-3.05-3.262-4.243-4.381C1.3 8.208 0 6.989 0 4.92 0 2.755 1.79 1 4 1c1.6 0 2.719 1.05 3.404 2.008.26.365.458.716.596.992a7.55 7.55 0 0 1 .596-.992C9.281 2.049 10.4 1 12 1c2.21 0 4 1.755 4 3.92 0 2.069-1.3 3.288-3.365 5.227-1.193 1.12-2.642 2.48-4.243 4.38z"})})};function z(e){return e?'"'.concat(e,'"'):"[ No Caption ]"}function T(e,t){var n;e.preventDefault(),n=function(e){return"https://www.google.com/maps/place/"+e.join(" ").replace(" ","+")}(t),window.open(n,"_blank").focus()}var q=function(e){var t=e.selected,n=e.onMediaLikeToggle,a=e.onClose,i=e.isLiked;console.log("selected:",t);var r=t.media,o=t.restaurant,s=r.source,u=r.caption,l=o.name,d=o.address,h=o.neighborhoods,f=o.categories,g=o.rating,b=function(){return n(r.id)};return Object(c.jsxs)(M.a,{isOpen:!!t,toggle:a,className:"media-modal-container",children:[Object(c.jsx)(B.a,{toggle:a,children:Object(c.jsx)("div",{className:"caption",children:z(u)})}),Object(c.jsx)(C.a,{children:Object(c.jsxs)("div",{className:"modal-info-container",children:[Object(c.jsxs)("div",{className:"modal-image-container",children:[Object(c.jsx)("img",{className:"food-media modal-image",src:s}),i?w("32","32","white",b):R("32","32","white",b)]}),Object(c.jsxs)("div",{className:"restaurant-details-container",children:[l&&Object(c.jsx)("div",{className:"restaurant-name",children:l}),d&&Object(c.jsx)("a",{onClick:function(e){return T(e,d)},className:"restaurant-address",children:d.join(" ")}),h&&Object(c.jsx)("div",{className:"restaurant-neighborhoods",children:h.join(", ")}),f&&Object(c.jsx)("div",{className:"restaurant-categories",children:f.join(", ")}),g&&Object(c.jsx)("div",{className:"restaurant-rating",children:g})]})]})}),Object(c.jsx)(L.a,{children:Object(c.jsx)(j.a,{color:"secondary",onClick:a,children:"Close"})})]})},F=n(16),P={restaurantsByID:{},mediaByID:{},restaurantIDsByMediaID:{}},A=function(){function e(){Object(p.a)(this,e)}return Object(x.a)(e,[{key:"update",value:function(e){!function(e,t){e.restaurantsByID=E(e.restaurantsByID,function(e){return e.reduce((function(e,t){return e[t.id]=t,e}),{})}(t)),e.mediaByID=E(e.mediaByID,function(e){return e.flatMap((function(e){return e.media})).reduce((function(e,t){return e[t.id]=t,e}),{})}(t)),e.restaurantIDsByMediaID=E(e.restaurantIDsByMediaID,function(e){return e.reduce((function(e,t){return E(e,function(e){return e.media.reduce((function(t,n){return t[n.id]=e.id,t}),{})}(t))}),{})}(t))}(P,e)}},{key:"getMediaByID",value:function(e){return P.mediaByID[e]}},{key:"getRestaurantByID",value:function(e){return P.restaurantsByID[e]}},{key:"getRestaurantIDByMediaID",value:function(e){return P.restaurantIDsByMediaID[e]}}]),e}();function E(e,t){return Object(F.a)(Object(F.a)({},e),t)}var J=function(){function e(t){Object(p.a)(this,e),this.storage=t}return Object(x.a)(e,[{key:"get",value:function(e){var t=this;return U((function(){return t.storage.getItem(e)}))}},{key:"set",value:function(e,t){var n=this;return U((function(){return n.storage.setItem(e,t)}))}},{key:"remove",value:function(e){var t=this;return U((function(){return t.storage.removeItem(e)}))}},{key:"removeAll",value:function(){var e=this;return U((function(){return e.storage.clear()}))}}]),e}();function U(e){try{return e()}catch(t){window.console.debug("Storage Exception:",t)}}var G=function(){function e(){Object(p.a)(this,e)}return Object(x.a)(e,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"remove",value:function(){}},{key:"removeAll",value:function(){}}]),e}(),Y=function(){function e(){Object(p.a)(this,e)}return Object(x.a)(e,[{key:"get",value:function(e){return e?new J(e):new G}}]),e}(),_=n(27),H=function(){function e(t,n){Object(p.a)(this,e),this.liked=function(e){return e?"string"===typeof e?function(e){var t=JSON.parse(e);for(var n in t)t[n]=new Set(t[n]);return t}(e):e:{}}(t),this.storage=n}return Object(x.a)(e,[{key:"toggle",value:function(e,t){var n,c,a=Object(F.a)({},this.liked);this.liked=K(a,e,t)?function(e,t,n){e[t].delete(n),0===e[t].size&&delete e[t];return e}(a,e,t):function(e,t,n){t in e||(e[t]=new Set);return e[t].add(n),e}(a,e,t),n=this.storage,c=this.serialize(),n.set("likedMedia",c)}},{key:"getAll",value:function(){return this.liked}},{key:"isLiked",value:function(e,t){return K(this.liked,e,t)}},{key:"serialize",value:function(){var e={};for(var t in this.liked)e[t]=Object(_.a)(this.liked[t]);return JSON.stringify(e)}}]),e}();function K(e,t,n){return t in e&&e[t].has(n)}var Q=new A,V=(new Y).get(window.localStorage),W=new H(function(e){try{return e.get("likedMedia")}catch(t){window.console.debug(t)}}(V),V);function X(e){return e&&W.isLiked(Q.getRestaurantIDByMediaID(e),e)}function Z(e,t,n){if(console.log("updateSearchURL()"),console.log("description:",e),console.log("location:",t),t){var c=function(e,t){return"/search?description=".concat(encodeURIComponent(e),"&location=").concat(encodeURIComponent(t))}(e,t);return console.log("url:",c),n(c)}}function $(e,t){return{media:t.getMediaByID(e),restaurant:t.getRestaurantByID(t.getRestaurantIDByMediaID(e))}}function ee(e){if(e.ok)return e;throw Error(e.statusText)}var te=function(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)([]),o=Object(s.a)(r,2),u=o[0],l=o[1],d=Object(a.useState)(""),j=Object(s.a)(d,2),h=j[0],f=j[1],g=Object(a.useState)({}),b=Object(s.a)(g,2),O=(b[0],b[1]),v=Object(a.useState)(!1),p=Object(s.a)(v,2),x=p[0],k=p[1],y=Object(a.useState)(null),N=Object(s.a)(y,2),w=N[0],I=N[1];return console.log("selectedMediaID:",h),Object(a.useEffect)((function(){n&&(console.log("Making request:",n),I(null),k(!0),fetch(n).then(ee).then((function(e){return e.json()})).then((function(e){Q.update(e),console.log("lookup:",Q),l(e),k(!1)})).catch((function(e){return I(e)})))}),[n]),Object(c.jsxs)("div",{className:"App",children:[Object(c.jsx)(m,{onSearchRequest:function(e,t){return Z(e,t,i)},searching:x}),h&&Object(c.jsx)(q,{selected:$(h,Q),onMediaLikeToggle:function(e){return function(e,t){W.toggle(Q.getRestaurantIDByMediaID(e),e),t(W.getAll())}(e,O)},onClose:function(){return f("")},isLiked:X(h)}),w?Object(c.jsx)(S,{error:w}):Object(c.jsx)(D,{restaurants:u,onMediaSelection:f,isLikedMedia:X})]})},ne=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,59)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),i(e),r(e)}))};o.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(te,{})}),document.getElementById("root")),ne()}},[[47,1,2]]]);
//# sourceMappingURL=main.0ea3af32.chunk.js.map