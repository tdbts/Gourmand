(this.webpackJsonpgourmand=this.webpackJsonpgourmand||[]).push([[0],{61:function(e,t,n){},62:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t);var c=n(3),i=n(2),r=n.n(i),a=n(18),o=n.n(a),s=(n(60),n(61),n(10)),u=(n(62),{UNKNOWN:"unknown",BIRDS_EYE:0,DRIVING:1,BIKING:2,WALKING:3,BLOCKS:4}),l=n(100),d=n(101),j=n(102),h=n(103),f=n(104),b=n(105),O=n(106),g=n(94),m=n(113),v=n(95),p=n(48),x=n(92),k=n(93);var N=function(e){var t=e.requestLocation;return Object(c.jsx)(x.a,{className:"suggestions-list-group",onMouseDown:function(e){return e.preventDefault()},children:Object(c.jsx)(k.a,{tag:"button",onClick:t,action:!0,children:Object(c.jsxs)("div",{className:"current-location-container",children:[Object(c.jsx)("img",{className:"current-location-icon",src:"cursor-fill.svg"}),Object(c.jsx)("span",{children:"Current Location"})]})})})};var y=function(e){var t=e.onSearchRequest,n=e.description,r=e.setDescription,a=e.location,o=e.setLocation,u=e.requestingLocation,l=e.setRequestingLocation,d=Object(i.useState)(!1),j=Object(s.a)(d,2),h=j[0],f=j[1],b=function(){return f(!1)};return Object(c.jsxs)("form",{className:"search-form",onSubmit:function(e){return function(e,t){e.preventDefault(),console.log("onSubmit()"),t()}(e,t)},children:[Object(c.jsx)("div",{className:"input-group-container",children:Object(c.jsxs)(g.a,{children:[Object(c.jsx)(m.a,{addonType:"prepend",children:Object(c.jsx)("img",{className:"input-icon query-icon",src:"magnifying-glass.svg"})}),Object(c.jsx)(v.a,{className:"search-input",type:"text",value:n,onChange:function(e){r(e.target.value)},placeholder:"e.g. Pizza"})]})}),Object(c.jsxs)("div",{className:"input-group-container",children:[Object(c.jsxs)(g.a,{children:[Object(c.jsx)(m.a,{addonType:"prepend",children:Object(c.jsx)("img",{className:"input-icon location-icon ".concat(u?"rotate":""),src:function(e){return e?"spinner.png":"target.svg"}(u)})}),Object(c.jsx)(v.a,{className:"search-input",type:"text",value:a,onChange:function(e){var t=e.target.value;t&&b(),o(t)},onClick:function(){return f((function(e){return!e}))},onBlur:b,placeholder:"e.g. Brooklyn, NY 11237"})]}),h&&Object(c.jsx)(N,{requestLocation:function(e){e.preventDefault(),console.log("Requesting location."),l(!0),b(),navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,n=t.latitude,c=t.longitude;l(!1),o("".concat(n.toPrecision(7),", ").concat(c.toPrecision(7)))}),(function(e){l(!1),console.error(e)}),{timeout:1e4,maximumAge:6e4})}})]}),Object(c.jsx)(p.a,{className:"search-submit-button hidden-submit",type:"submit"})]})},w=n(96),D=n(97);var I=function(e){var t=e.onChange;return Object(c.jsx)(w.a,{className:"header-check filter-liked-check",check:!0,children:Object(c.jsxs)(D.a,{check:!0,children:[Object(c.jsx)(v.a,{type:"checkbox",onChange:function(e){return t(e.target.checked)}}),Object(c.jsx)("span",{className:"header-check-text",children:"Show Liked"})]})})},S=n(98),L=n(114),C=n(115),B=n(99),M=u,R={DEFAULT:"Distance",options:["Bird's-eye View","Driving (5 mi.)","Biking (2 mi.)","Walking (1 mi.)","Within 4 Blocks"]};function q(e){return e===M.UNKNOWN?R.DEFAULT:R.options[e]}var E=function(e){var t=e.distance,n=e.setDistance,r=(e.onSearchRequest,Object(i.useState)(!1)),a=Object(s.a)(r,2),o=a[0],u=a[1];return Object(c.jsxs)(S.a,{className:"distance-dropdown",isOpen:o,toggle:function(){return u(!o)},size:"sm",outline:!0,color:"secondary",children:[Object(c.jsx)(L.a,{caret:!0,children:q(t)}),Object(c.jsxs)(C.a,{positionFixed:!0,children:[Object(c.jsx)(B.a,{onClick:function(){return n(M.BLOCKS)},children:"Within 4 Blocks"}),Object(c.jsx)(B.a,{onClick:function(){return n(M.WALKING)},children:"Walking (1 mi.)"}),Object(c.jsx)(B.a,{onClick:function(){return n(M.BIKING)},children:"Biking (2 mi.)"}),Object(c.jsx)(B.a,{onClick:function(){return n(M.DRIVING)},children:"Driving (5 mi.)"}),Object(c.jsx)(B.a,{onClick:function(){return n(M.BIRDS_EYE)},children:"Bird's-eye View"})]})]})};var U=function(e){var t=e.onSearchRequest,n=e.description,r=e.setDescription,a=e.location,o=e.setLocation,u=e.requestingLocation,g=e.setRequestingLocation,m=e.setShowLiked,v=e.distance,p=e.setDistance,x=Object(i.useState)(!1),k=Object(s.a)(x,2),N=k[0],w=k[1];return Object(c.jsxs)(l.a,{className:"header-navbar",color:"light",light:!0,expand:"md",children:[Object(c.jsx)(d.a,{href:"/",children:"Gourmand"}),Object(c.jsx)(j.a,{onClick:function(){return w(!N)}}),Object(c.jsx)(h.a,{className:"header-collapse",in:!0,isOpen:N,timeout:200,navbar:!0,children:Object(c.jsxs)(f.a,{className:"header-nav",navbar:!0,children:[Object(c.jsx)(b.a,{children:Object(c.jsx)(O.a,{href:"#",children:"About"})}),Object(c.jsx)(b.a,{children:Object(c.jsx)(O.a,{href:"#",children:"Contact"})}),Object(c.jsx)(b.a,{children:Object(c.jsx)(O.a,{href:"#",children:"Log In"})}),Object(c.jsx)(b.a,{className:"nav-separator"}),Object(c.jsx)(b.a,{children:Object(c.jsx)(y,{description:n,setDescription:r,location:a,setLocation:o,requestingLocation:u,setRequestingLocation:g,onSearchRequest:t})}),Object(c.jsxs)(b.a,{className:"dropdown-nav-item",children:[Object(c.jsx)(E,{distance:v,setDistance:p,onSearchRequest:t}),Object(c.jsx)(I,{onChange:m})]})]})})]})},A=n(32),T=n(13),K=n(14),W=n(53),z=n(51),F=function(e){Object(W.a)(n,e);var t=Object(z.a)(n);function n(e,c,i,r){return Object(T.a)(this,n),t.call(this,e,c,i,r)}return Object(K.a)(n,[{key:"getThumbnailURLs",value:function(){var e=this.source.slice(0,-5);return[e+"258s.jpg",e+"300s.jpg",e+"348s.jpg"]}}]),n}(function(){function e(t,n,c,i){Object(T.a)(this,e),this.id=t,this.type=n,this.caption=c,this.source=i}return Object(K.a)(e,[{key:"toJSON",value:function(){return A.a.pick(this,"id","type","caption","source")}},{key:"populateFromBSON",value:function(e){var t=e.id,n=e.type,c=e.caption,i=e.source;return this.id=t,this.type=n,this.caption=c,this.source=i,this}}]),e}()),G=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return Object(c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:t,fill:n,className:"liked-media-icon",onClick:i,viewBox:"0 0 16 16",children:Object(c.jsx)("path",{d:"M4 1c2.21 0 4 1.755 4 3.92C8 2.755 9.79 1 12 1s4 1.755 4 3.92c0 3.263-3.234 4.414-7.608 9.608a.513.513 0 0 1-.784 0C3.234 9.334 0 8.183 0 4.92 0 2.755 1.79 1 4 1z"})})},P=[50,250,500,750,1e3],J=function(e){var t=e.media,n=e.onMediaSelection,i=e.isLiked,r=(e.searching,Math.floor(Math.random()*P.length)),a=P[r];return Object(c.jsxs)("div",{className:"food-thumbnail-container transition-delay-".concat(a),children:[Object(c.jsx)("img",{className:"food-thumbnail",src:t.getThumbnailURLs()[0],onClick:function(){return n(t.id)}}),i&&G("16","16","white")]})},V=n(107),Y=function(e){var t=e.color;return Object(c.jsxs)("div",{className:"search-curtain",children:[Object(c.jsx)("div",{className:"search-curtain-backdrop"}),Object(c.jsx)(V.a,{className:"search-curtain-spinner",color:t})]})},_=n(111);var H=function(e){var t=e.restaurants,n=e.onMediaSelection,r=e.isLikedMedia,a=e.searching,o=e.showLiked,u=Object(i.useState)(!0),l=Object(s.a)(u,2),d=l[0],j=l[1],h=Object(i.useState)([]),f=Object(s.a)(h,2),b=f[0],O=f[1],g=Object(i.useState)(!0),m=Object(s.a)(g,2),v=m[0],p=m[1],x=t.length?"light":"dark",k=!a&&v,N=function(e,t,n){return t?e.filter((function(e){return n(e.id)})):e}(b,o,r);return Object(i.useEffect)((function(){j(k)}),[a,v]),Object(i.useEffect)((function(){d&&O(function(e){console.log("restaurants:",e);var t=e.flatMap((function(e){return e.media}));return console.log("allMedia:",t),A.a.shuffle(t).map((function(e){return(new F).populateFromBSON(e)}))}(t))}),[d]),Object(c.jsx)(_.a,{classNames:"thumbnail-swap",in:k,appear:!0,timeout:2e3,onExit:function(){return p(!1)},onExited:function(){j(!0),p(!0)},children:Object(c.jsxs)("div",{className:"gallery-container",children:[N.map((function(e,t){return Object(c.jsx)(J,{searching:a,media:e,onMediaSelection:n,isLiked:r(e.id)},t)})),a&&Object(c.jsx)(Y,{color:x})]})})},Q=function(e){var t=e.error;return Object(c.jsxs)("div",{className:"error-message-container",children:[Object(c.jsx)("div",{className:"error-apology",children:"Oops, something went sour."}),Object(c.jsxs)("div",{className:"error-message",children:['"',t.message,'"']})]})},X=n(112),Z=n(108),$=n(109),ee=n(110),te=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return Object(c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:t,fill:n,className:"unliked-media-icon",onClick:i,viewBox:"0 0 16 16",children:Object(c.jsx)("path",{d:"M8 6.236l-.894-1.789c-.222-.443-.607-1.08-1.152-1.595C5.418 2.345 4.776 2 4 2 2.324 2 1 3.326 1 4.92c0 1.211.554 2.066 1.868 3.37.337.334.721.695 1.146 1.093C5.122 10.423 6.5 11.717 8 13.447c1.5-1.73 2.878-3.024 3.986-4.064.425-.398.81-.76 1.146-1.093C14.446 6.986 15 6.131 15 4.92 15 3.326 13.676 2 12 2c-.777 0-1.418.345-1.954.852-.545.515-.93 1.152-1.152 1.595L8 6.236zm.392 8.292a.513.513 0 0 1-.784 0c-1.601-1.902-3.05-3.262-4.243-4.381C1.3 8.208 0 6.989 0 4.92 0 2.755 1.79 1 4 1c1.6 0 2.719 1.05 3.404 2.008.26.365.458.716.596.992a7.55 7.55 0 0 1 .596-.992C9.281 2.049 10.4 1 12 1c2.21 0 4 1.755 4 3.92 0 2.069-1.3 3.288-3.365 5.227-1.193 1.12-2.642 2.48-4.243 4.38z"})})};function ne(e){return e?'"'.concat(e,'"'):"[ No Caption ]"}function ce(e,t){var n;e.preventDefault(),n=function(e){return"https://www.google.com/maps/place/"+e.join(" ").replace(" ","+")}(t),window.open(n,"_blank").focus()}var ie=function(e){var t=e.selected,n=e.onMediaLikeToggle,i=e.onClose,r=e.isLiked;console.log("selected:",t);var a=t.media,o=t.restaurant,s=a.source,u=a.caption,l=o.name,d=o.address,j=o.neighborhoods,h=o.categories,f=o.rating,b=function(){return n(a.id)};return Object(c.jsxs)(X.a,{isOpen:!!t,toggle:i,className:"media-modal-container",children:[Object(c.jsx)(Z.a,{toggle:i,children:Object(c.jsx)("div",{className:"caption",children:ne(u)})}),Object(c.jsx)($.a,{children:Object(c.jsxs)("div",{className:"modal-info-container",children:[Object(c.jsxs)("div",{className:"modal-image-container",children:[Object(c.jsx)("img",{className:"food-media modal-image",src:s}),r?G("32","32","white",b):te("32","32","white",b)]}),Object(c.jsxs)("div",{className:"restaurant-details-container",children:[l&&Object(c.jsx)("div",{className:"restaurant-name",children:l}),d&&Object(c.jsx)("a",{onClick:function(e){return ce(e,d)},className:"restaurant-address",children:d.join(" ")}),j&&Object(c.jsx)("div",{className:"restaurant-neighborhoods",children:j.join(", ")}),h&&Object(c.jsx)("div",{className:"restaurant-categories",children:h.join(", ")}),f&&Object(c.jsx)("div",{className:"restaurant-rating",children:f})]})]})}),Object(c.jsx)(ee.a,{children:Object(c.jsx)(p.a,{color:"secondary",onClick:i,children:"Close"})})]})},re=n(28),ae={restaurantsByID:{},mediaByID:{},restaurantIDsByMediaID:{}},oe=function(){function e(){Object(T.a)(this,e)}return Object(K.a)(e,[{key:"update",value:function(e){!function(e,t){e.restaurantsByID=se(e.restaurantsByID,function(e){return e.reduce((function(e,t){return e[t.id]=t,e}),{})}(t)),e.mediaByID=se(e.mediaByID,function(e){return e.flatMap((function(e){return e.media})).reduce((function(e,t){return e[t.id]=t,e}),{})}(t)),e.restaurantIDsByMediaID=se(e.restaurantIDsByMediaID,function(e){return e.reduce((function(e,t){return se(e,function(e){return e.media.reduce((function(t,n){return t[n.id]=e.id,t}),{})}(t))}),{})}(t))}(ae,e)}},{key:"getMediaByID",value:function(e){return ae.mediaByID[e]}},{key:"getRestaurantByID",value:function(e){return ae.restaurantsByID[e]}},{key:"getRestaurantIDByMediaID",value:function(e){return ae.restaurantIDsByMediaID[e]}}]),e}();function se(e,t){return Object(re.a)(Object(re.a)({},e),t)}var ue=function(){function e(t){Object(T.a)(this,e),this.storage=t}return Object(K.a)(e,[{key:"get",value:function(e){var t=this;return le((function(){return t.storage.getItem(e)}))}},{key:"set",value:function(e,t){var n=this;return le((function(){return n.storage.setItem(e,t)}))}},{key:"remove",value:function(e){var t=this;return le((function(){return t.storage.removeItem(e)}))}},{key:"removeAll",value:function(){var e=this;return le((function(){return e.storage.clear()}))}}]),e}();function le(e){try{return e()}catch(t){window.console.debug("Storage Exception:",t)}}var de=function(){function e(){Object(T.a)(this,e)}return Object(K.a)(e,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"remove",value:function(){}},{key:"removeAll",value:function(){}}]),e}(),je=function(){function e(){Object(T.a)(this,e)}return Object(K.a)(e,[{key:"get",value:function(e){return e?new ue(e):new de}}]),e}(),he=n(52),fe=function(){function e(t,n){Object(T.a)(this,e),this.liked=function(e){return e?"string"===typeof e?function(e){var t=JSON.parse(e);for(var n in t)t[n]=new Set(t[n]);return t}(e):e:{}}(t),this.storage=n}return Object(K.a)(e,[{key:"toggle",value:function(e,t){var n,c,i=Object(re.a)({},this.liked);this.liked=be(i,e,t)?function(e,t,n){e[t].delete(n),0===e[t].size&&delete e[t];return e}(i,e,t):function(e,t,n){t in e||(e[t]=new Set);return e[t].add(n),e}(i,e,t),n=this.storage,c=this.serialize(),n.set("likedMedia",c)}},{key:"getAll",value:function(){return this.liked}},{key:"isLiked",value:function(e,t){return be(this.liked,e,t)}},{key:"serialize",value:function(){var e={};for(var t in this.liked)e[t]=Object(he.a)(this.liked[t]);return JSON.stringify(e)}}]),e}();function be(e,t,n){return t in e&&e[t].has(n)}var Oe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},ge=u;var me=function(e,t){var n=t.description,c=t.location,i=t.distance;return[e,Oe((function(e){return function(e,t){return t.concat("description=".concat(encodeURIComponent(e)))}(n,e)}),(function(e){return function(e,t){return t.concat("location=".concat(encodeURIComponent(e)))}(c,e)}),(function(e){return function(e,t){return e&&e!==ge.UNKNOWN?t.concat("distance=".concat(encodeURIComponent(e))):t}(i,e)}))([]).join("&")].join("?")},ve=u,pe=new oe,xe=(new je).get(window.localStorage),ke=new fe(function(e){try{return e.get("likedMedia")}catch(t){window.console.debug(t)}}(xe),xe);function Ne(e){return e&&ke.isLiked(pe.getRestaurantIDByMediaID(e),e)}function ye(e,t){var n=e.description,c=e.location,i=e.distance;if(console.log("updateSearchURL()"),console.log("description:",n),console.log("location:",c),console.log("distance:",i),c){var r=me("/search",{description:n,location:c,distance:i});return console.log("url:",r),t(r)}}function we(e,t){return{media:t.getMediaByID(e),restaurant:t.getRestaurantByID(t.getRestaurantIDByMediaID(e))}}function De(e){if(e.ok)return e;throw new Error(e.statusText)}function Ie(e){if(e.some((function(e){return e.mediaCount>0})))return e;throw new Error("Nothing to see here.")}var Se=function(){var e=Object(i.useState)(""),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)([]),o=Object(s.a)(a,2),u=o[0],l=o[1],d=Object(i.useState)(""),j=Object(s.a)(d,2),h=j[0],f=j[1],b=Object(i.useState)(""),O=Object(s.a)(b,2),g=O[0],m=O[1],v=Object(i.useState)(!1),p=Object(s.a)(v,2),x=p[0],k=p[1],N=Object(i.useState)(""),y=Object(s.a)(N,2),w=y[0],D=y[1],I=Object(i.useState)({}),S=Object(s.a)(I,2),L=(S[0],S[1]),C=Object(i.useState)(!1),B=Object(s.a)(C,2),M=B[0],R=B[1],q=Object(i.useState)(null),E=Object(s.a)(q,2),A=E[0],T=E[1],K=Object(i.useState)(ve.UNKNOWN),W=Object(s.a)(K,2),z=W[0],F=W[1],G=Object(i.useState)(!1),P=Object(s.a)(G,2),J=P[0],V=P[1];return Object(i.useEffect)((function(){n&&(console.log("Making request:",n),T(null),R(!0),fetch(n).then(De).then((function(e){return e.json()})).then(Ie).then((function(e){pe.update(e),console.log("lookup:",pe),l(e),R(!1),window.scroll({top:0,left:0,behavior:"smooth"})})).catch((function(e){return T(e)})))}),[n]),Object(i.useEffect)((function(){ye({description:h,location:g,distance:z},r)}),[z]),Object(c.jsxs)("div",{className:"app",children:[Object(c.jsx)(U,{onSearchRequest:function(){return ye({description:h,location:g,distance:z},r)},description:h,setDescription:f,location:g,setLocation:m,requestingLocation:x,setRequestingLocation:k,setShowLiked:V,distance:z,setDistance:F}),w&&Object(c.jsx)(ie,{selected:we(w,pe),onMediaLikeToggle:function(e){return function(e,t){ke.toggle(pe.getRestaurantIDByMediaID(e),e),t(ke.getAll())}(e,L)},onClose:function(){return D("")},isLiked:Ne(w)}),A?Object(c.jsx)(Q,{error:A}):Object(c.jsx)(H,{restaurants:u,onMediaSelection:D,isLikedMedia:Ne,searching:M,showLiked:J})]})},Le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,116)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),i(e),r(e),a(e)}))};o.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(Se,{})}),document.getElementById("root")),Le()}},[[90,1,2]]]);
//# sourceMappingURL=main.e027ea01.chunk.js.map